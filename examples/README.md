# ROS GridMap Generator - Simulator Examples

This directory contains Docker-based examples for testing maps generated by ROS GridMap Generator with various simulators.

## ğŸ¯ Overview

Each simulator example provides a complete Docker environment to test the exported map files:
- **Gazebo Classic** - 3D simulation with ROS1 Noetic
- **Gazebo Modern** - Latest Gazebo with ROS2 Jazzy  
- **MVSim** - Multi-vehicle 2D simulator with ROS2 Humble
- **Flatland** - High-performance 2D simulator with ROS1

## ğŸš€ Quick Start

### Prerequisites
- Docker and Docker Compose installed
- X11 server running (for GUI display)
- Exported map files from ROS GridMap Generator

### Setup X11 for GUI (Linux)
```bash
xhost +local:docker
```

### Export Maps First
1. Open [ROS GridMap Generator](https://ar90n.github.io/ros-gridmap-gen/)
2. Create your map by placing walls and setting parameters
3. Select desired formats (ROS1/ROS2 + Simulator)
4. Click "Export Files" to download the ZIP
5. Extract the ZIP contents to `shared/maps/` directory

### Run a Simulator
```bash
# Navigate to examples directory
cd examples

# Build and run specific simulator
docker-compose run --rm gazebo-classic
docker-compose run --rm gazebo-ignition
docker-compose run --rm mvsim
docker-compose run --rm flatland
```

## ğŸ“ Directory Structure
```
examples/
â”œâ”€â”€ docker-compose.yml          # Multi-simulator orchestration
â”œâ”€â”€ shared/                     # Shared map files
â”‚   â””â”€â”€ maps/                   # Place exported files here
â”‚       â”œâ”€â”€ map.pgm
â”‚       â”œâ”€â”€ map_ros1.yaml
â”‚       â”œâ”€â”€ map_ros2.yaml
â”‚       â”œâ”€â”€ world_classic.sdf
â”‚       â”œâ”€â”€ world_ignition.sdf
â”‚       â””â”€â”€ world_mvsim.xml
â”‚
â”œâ”€â”€ gazebo-classic/             # Gazebo Classic + ROS1
â”œâ”€â”€ gazebo-ignition/            # Gazebo Fortress + ROS2
â”œâ”€â”€ mvsim/                      # MVSim + ROS2
â””â”€â”€ flatland/                   # Flatland + ROS1
```

## ğŸ® Simulator Comparison

| Simulator | ROS Version | Dimensions | Physics | Use Case |
|-----------|-------------|------------|---------|----------|
| **Gazebo Classic** | ROS1 Noetic | 3D | Full | Detailed robot simulation |
| **Gazebo Modern** | ROS2 Jazzy | 3D | Full | Latest Gazebo features |
| **MVSim** | ROS2 Humble | 2D | Realistic | Multi-vehicle scenarios |
| **Flatland** | ROS1 Noetic | 2D | Lightweight | High-performance 2D sim |

## ğŸ“‹ File Requirements

Each simulator requires different exported files:

### Gazebo Classic
- âœ… `world_classic.sdf` - World geometry
- âœ… `map_ros1.yaml` + `map.pgm` - For navigation

### Gazebo Modern  
- âœ… `world_ignition.sdf` - World geometry
- âœ… `map_ros2.yaml` + `map.pgm` - For navigation

### MVSim
- âœ… `world_mvsim.xml` - Complete world definition
- âš ï¸ `map_ros2.yaml` + `map.pgm` - For reference only

### Flatland
- âœ… `map_ros1.yaml` + `map.pgm` - Primary format
- âŒ No world file needed

## ğŸ”§ Common Commands

### Build All Images
```bash
docker compose build
```

### Run Specific Simulator
```bash
# Interactive shell
docker compose run --rm <simulator-name>

# Run specific command
docker compose run --rm gazebo-classic roslaunch /workspace/launch/test_map.launch
```

### Clean Up
```bash
# Remove containers
docker compose down

# Remove images
docker compose down --rmi all

# Remove everything including volumes
docker compose down --rmi all --volumes --remove-orphans
```

## ğŸ› Troubleshooting

### GUI Not Showing
```bash
# Enable X11 forwarding
xhost +local:docker

# Check DISPLAY variable
echo $DISPLAY

# For WSL2, use VcXsrv or similar X server
```

### Docker Build Fails
```bash
# Clear Docker cache
docker system prune -a

# Build without cache
docker compose build --no-cache <service-name>
```

### Map Files Not Found
1. Make sure files are in `shared/maps/` directory
2. Check file permissions: `chmod 644 shared/maps/*`
3. Verify file contents aren't empty

### Performance Issues
```bash
# Limit container resources
docker compose run --rm --cpus=2 --memory=4g <service-name>

# Use headless mode when available
export DISPLAY=:99
```

## ğŸ¯ Usage Examples

### Test Generated World in Gazebo Classic
```bash
docker compose run --rm gazebo-classic
# Inside container:
roslaunch /workspace/launch/test_world.launch
```

### Navigation Stack with Map Server
```bash
docker compose run --rm gazebo-classic
# Inside container:
roslaunch /workspace/launch/test_map.launch
```

### Test Gazebo Modern World
```bash
docker compose run --rm gazebo-ignition
# Inside container:
ros2 launch /workspace/launch/test_world.launch.py  # World only
ros2 launch /workspace/launch/test_map.launch.py    # Full navigation stack
```

### Multi-Vehicle Simulation with MVSim
```bash
docker compose run --rm mvsim
# Inside container:
ros2 run mvsim mvsim_node /workspace/maps/world_mvsim.xml  # Recommended
ros2 launch ./launch/test_world.launch.py  # Auto-fallback version
```

### High-Performance 2D Simulation with Flatland
```bash
docker compose run --rm flatland
# Inside container:
roslaunch /workspace/launch/test_map.launch
```

## ğŸ”— Related Links

- [ROS GridMap Generator](https://ar90n.github.io/ros-gridmap-gen/) - Main application
- [GitHub Repository](https://github.com/ar90n/ros-gridmap-gen) - Source code
- [Gazebo Documentation](http://gazebosim.org/) - Gazebo simulator
- [MVSim Documentation](https://mvsimulator.readthedocs.io/) - MVSim simulator
- [Flatland Documentation](https://flatland-simulator.readthedocs.io/) - Flatland simulator

## ğŸ“ Notes

- **Build Time**: Flatland takes the longest to build (~5-10 minutes) as it compiles from source
- **Resource Usage**: 3D simulators (Gazebo) use more CPU/GPU than 2D simulators
- **ROS Bridge**: Use appropriate ROS version bridges if mixing ROS1/ROS2 components
- **Headless Mode**: All simulators support headless operation for CI/CD environments